# テスト設計

## 8.1 単体テスト設計

### テスト対象
- **ビジネスロジック**: SearchService, PaginationService
- **APIクライアント**: MicroCMSClient
- **ユーティリティ関数**: 各種ヘルパー関数
- **Reactコンポーネント**: ArticleCard, ArticleList, Pagination等

### テストカバレッジ目標
- **ビジネスロジック**: 80%以上
- **APIクライアント**: 70%以上
- **Reactコンポーネント**: 60%以上
- **全体**: 70%以上

### テストケース例

#### SearchService.searchBlogs

##### テストケース1: 正常系 - タイトルに一致する記事を検索
- **入力**: blogs = [記事1, 記事2], query = "タイトル1"
- **期待結果**: [記事1]が返される
- **前提条件**: 記事1のタイトルに"タイトル1"が含まれる

##### テストケース2: 正常系 - 本文に一致する記事を検索
- **入力**: blogs = [記事1, 記事2], query = "本文"
- **期待結果**: 本文に"本文"が含まれる記事が返される
- **前提条件**: 記事1の本文に"本文"が含まれる

##### テストケース3: 正常系 - カテゴリ名に一致する記事を検索
- **入力**: blogs = [記事1, 記事2], query = "カテゴリ1"
- **期待結果**: カテゴリ名に"カテゴリ1"が含まれる記事が返される
- **前提条件**: 記事1のカテゴリ名が"カテゴリ1"

##### テストケース4: 正常系 - タグ名に一致する記事を検索
- **入力**: blogs = [記事1, 記事2], query = "タグ1"
- **期待結果**: タグ名に"タグ1"が含まれる記事が返される
- **前提条件**: 記事1のタグに"タグ1"が含まれる

##### テストケース5: 異常系 - 空の検索クエリ
- **入力**: blogs = [記事1, 記事2], query = ""
- **期待結果**: 空配列が返される

##### テストケース6: 異常系 - 一致する記事がない
- **入力**: blogs = [記事1, 記事2], query = "存在しない"
- **期待結果**: 空配列が返される

#### PaginationService.paginate

##### テストケース1: 正常系 - 1ページ目を取得
- **入力**: items = [1,2,3,4,5,6,7,8,9,10], page = 1, perPage = 5
- **期待結果**: { items: [1,2,3,4,5], totalPages: 2 }

##### テストケース2: 正常系 - 2ページ目を取得
- **入力**: items = [1,2,3,4,5,6,7,8,9,10], page = 2, perPage = 5
- **期待結果**: { items: [6,7,8,9,10], totalPages: 2 }

##### テストケース3: 異常系 - ページ番号が範囲外
- **入力**: items = [1,2,3], page = 10, perPage = 5
- **期待結果**: { items: [], totalPages: 1 }

#### ArticleCardコンポーネント

##### テストケース1: 正常系 - 記事カードが正しく表示される
- **入力**: blog = { id: "1", title: "タイトル", ... }
- **期待結果**: タイトル、公開日時、カテゴリが表示される

##### テストケース2: 正常系 - アイキャッチ画像が表示される
- **入力**: blog = { id: "1", eyecatch: { url: "..." }, ... }
- **期待結果**: アイキャッチ画像が表示される

## 8.2 結合テスト設計

### テスト対象
- **ページコンポーネント**: トップページ、記事詳細ページ等
- **API連携**: microCMS APIとの連携
- **データフロー**: データ取得から表示までの一連の流れ

### テストシナリオ

#### シナリオ1: トップページ表示

##### 前提条件
- microCMSに記事データが存在する
- ビルドが正常に完了している

##### テスト手順
1. トップページにアクセス
2. 記事一覧が表示されることを確認
3. ページネーションが動作することを確認

##### 期待結果
- 記事一覧が正しく表示される
- ページネーションが正常に動作する
- カテゴリ・タグフィルタが正常に動作する

#### シナリオ2: 記事詳細ページ表示

##### 前提条件
- 記事IDが存在する
- ビルドが正常に完了している

##### テスト手順
1. 記事詳細ページにアクセス
2. 記事本文が表示されることを確認
3. マークダウンが正しくHTMLに変換されることを確認

##### 期待結果
- 記事詳細が正しく表示される
- マークダウンが正しくHTMLに変換される
- 画像が正しく表示される

#### シナリオ3: 検索機能

##### 前提条件
- 記事データが存在する
- 検索機能が実装されている

##### テスト手順
1. 検索ボックスにクエリを入力
2. 検索ボタンをクリック
3. 検索結果が表示されることを確認

##### 期待結果
- 検索結果が正しく表示される
- 検索結果から記事詳細ページに遷移できる

## 8.3 テストデータ設計

### テストデータ要件
- **記事データ**: 10件以上（ページネーションテスト用）
- **カテゴリデータ**: 3件以上（カテゴリフィルタテスト用）
- **タグデータ**: 5件以上（タグフィルタテスト用）
- **多様なデータ**: 様々な形式の記事データ（画像あり/なし、長文/短文等）

### テストデータ作成方法
- **開発環境**: microCMSの開発環境でテストデータを作成
- **モックデータ**: 単体テスト用にモックデータを作成

### テストデータ管理
- **開発環境**: microCMSの開発環境で管理
- **テストコード**: テストコード内でモックデータを定義
- **データリセット**: 必要に応じてテストデータをリセット

## 8.4 E2Eテスト設計（将来検討）

### テスト対象
- **主要ユーザーフロー**: 記事閲覧、検索、カテゴリ・タグフィルタ等

### テストツール
- **Playwright**: E2Eテストフレームワーク
- **Cypress**: 代替案

### テストシナリオ
- トップページから記事詳細ページへの遷移
- 検索機能の動作確認
- カテゴリ・タグフィルタの動作確認
- レスポンシブデザインの確認




