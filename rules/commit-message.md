# コミットメッセージのルール

このリポジトリでのコミットメッセージの書き方について説明します。

## 基本形式

コミットメッセージは以下の形式に従ってください：

```
<タイプ>: <件名>

<本文（オプション）>

<フッター（オプション）>
```

## タイプ

コミットの種類を表すタイプは以下のいずれかを使用してください：

### 開発モードでのタイプ

- **feat**: 新機能の追加
- **fix**: バグ修正
- **docs**: ドキュメントの追加・変更
- **style**: コードスタイルの変更（フォーマット、インデントなど）
- **refactor**: リファクタリング（機能変更なし）
- **test**: テストの追加・変更
- **chore**: ビルドプロセスやツールの変更
- **perf**: パフォーマンスの改善

### 計画モードでのタイプ

- **template**: テンプレートの追加・変更
- **rule**: ルールや設定の変更（`.cursorrules`、`README.md`など）
- **structure**: ディレクトリ構造の変更
- **docs**: ドキュメントの追加・変更
- **refactor**: リファクタリング（機能変更なし）

## 件名

- 50文字以内で簡潔に記述
- 日本語で記述
- 動詞で始める（例：「追加」「修正」「更新」「削除」）
- 句読点（。、）は使用しない

### 良い例

```
feat: ユーザー認証機能を追加
fix: ログイン時のエラーハンドリングを修正
docs: 要件定義書のテンプレートを更新
template: API詳細仕様のテンプレートを追加
rule: 詳細設計のapiとscreensをdraft/fixedフォルダ内に移動
```

### 悪い例

```
feat: ユーザー認証機能を追加しました。
fix: ログイン時のエラーハンドリングを修正する
feat: ユーザー認証
feat: ユーザー認証機能を追加。ログイン画面とAPIエンドポイントを実装。
```

## 本文（オプション）

必要に応じて、本文を追加してください。

- 1行目は空行にする
- 72文字以内で折り返す
- 変更の理由や背景を説明
- 箇条書きを使用して複数の変更を列挙

### 例

```
feat: ユーザー認証機能を追加

- ログイン画面の実装
- 認証APIエンドポイントの追加
- セッション管理機能の実装
- パスワードハッシュ化の実装
```

## フッター（オプション）

必要に応じて、フッターを追加してください。

- 関連するIssue番号を記載
- 破壊的変更がある場合は明記

### 例

```
feat: ユーザー認証機能を追加

- ログイン画面の実装
- 認証APIエンドポイントの追加

Closes #123
BREAKING CHANGE: 認証方式が変更されました
```

## モード別の推奨形式

### 開発モード

開発モードでは、プロジェクト固有の変更を行います。

```
<タイプ>: <変更内容>

<詳細な変更内容（箇条書き）>
```

### 計画モード

計画モードでは、基盤リポジトリの改善を行います。

```
<タイプ>: <変更内容>

<変更の理由や背景>
<詳細な変更内容（箇条書き）>
```

## 複数の変更を含む場合

1つのコミットに複数の変更を含める場合は、本文で箇条書きにします。

```
feat: ユーザー管理機能を追加

- ユーザー一覧画面の実装
- ユーザー詳細画面の実装
- ユーザー編集APIの追加
- ユーザー削除APIの追加
```

## コミットメッセージの例

### 開発モードの例

```
feat: ログイン機能を実装

- ログイン画面のUI実装
- 認証APIエンドポイントの追加
- セッション管理機能の実装
```

```
fix: パスワードリセット機能のバグを修正

- メール送信処理のエラーハンドリングを改善
- トークンの有効期限チェックを追加
```

```
docs: 要件定義書を更新

- ユーザー管理機能の要件を追加
- セキュリティ要件を詳細化
```

### 計画モードの例

```
rule: 詳細設計のapiとscreensをdraft/fixedフォルダ内に移動

- draft/api/ と draft/screens/ ディレクトリを作成
- fixed/api/ と fixed/screens/ ディレクトリを作成
- テンプレートファイルを draft/ 内に配置
- 既存の api/ と screens/ ディレクトリを削除
- template.md, .cursorrules, Docs/README.md を更新して新しい構造を反映
- 各APIや画面を個別にfixしたか確認し、確定したものは fixed/ に移動するルールを追加
```

```
template: API詳細仕様のテンプレートを追加

- API詳細仕様のテンプレートファイルを作成
- リクエスト・レスポンスの記載例を追加
- エラーハンドリングの記載例を追加
```

```
structure: フィードバックディレクトリを追加

- Docs/feedback/ ディレクトリを作成
- フィードバックテンプレートを追加
- フィードバックの使い方をREADMEに記載
```

## 注意事項

- コミットメッセージは変更内容を明確に表現する
- 将来の自分や他の開発者が理解しやすいように記述する
- 1つのコミットには関連する変更のみを含める
- コミットメッセージは変更の「何を」「なぜ」を説明する

## 関連ルール

- [フェーズ移行時のルール](./phase-transition.md) - フェーズ移行時のコミット・プッシュルール

## 参考

- [Conventional Commits](https://www.conventionalcommits.org/)
- [Git コミットメッセージのベストプラクティス](https://qiita.com/itosho/items/9565c6ad2a1c7b012052)

